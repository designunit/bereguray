import s from './styles.module.css'

export type BubbleProps = {
    style?: React.CSSProperties
    duration?: number
    color?: string
    opacity?: number
    picturePath?: string
}

export const Bubble: React.FC<BubbleProps & React.HTMLAttributes<HTMLDivElement>> = ({ 
    duration = 15 + Math.random()*60, 
    picturePath, 
    color = 'white', 
    opacity = 1, 
    ...props 
}) => {
    const path = (
        <path fill-rule="evenodd" clip-rule="evenodd" fill={color} opacity={opacity} >
            <animate dur={`${duration}s`} repeatCount="indefinite" attributeName='d'   
                calcMode='spline' // ease-in-out
                keyTimes="0 ; 0.25 ; 0.5 ; 0.75 ; 1"
                keySplines="0.5 0 0.5 1 ; 0.5 0 0.5 1 ; 0.5 0 0.5 1 ; 0.5 0 0.5 1"
                values="
                    M0.504945 0.0798826C0.57125 0.0561591 0.643505 -0.0291317 0.702467 0.0102251C0.769698 0.0551018 0.727095 0.173593 0.759073 0.249511C0.777937 0.294296 0.816483 0.325816 0.849922 0.36029C0.895524 0.407303 0.973401 0.427999 0.993575 0.491272C1.01226 0.549881 0.988074 0.622815 0.948275 0.668763C0.905234 0.718452 0.817377 0.69955 0.772054 0.747013C0.734446 0.786396 0.763216 0.866643 0.723687 0.903953C0.686392 0.939154 0.625385 0.921021 0.57605 0.932012C0.525586 0.943256 0.478017 0.962114 0.426971 0.97006C0.363955 0.979871 0.290214 1.0224 0.23795 0.984648C0.184233 0.945849 0.221886 0.844399 0.180373 0.791946C0.136568 0.736596 0.0181766 0.755904 0.00187867 0.686362C-0.0148224 0.6151 0.0845813 0.568044 0.11206 0.500458C0.131407 0.452872 0.118981 0.396758 0.138872 0.349413C0.159072 0.301333 0.191778 0.260252 0.228256 0.223886C0.265158 0.187098 0.308294 0.158702 0.354063 0.134882C0.402112 0.109875 0.454117 0.0980687 0.504945 0.0798826Z ;
                    M0.573262 0.0165297C0.636415 -0.00147284 0.705922 -0.0061385 0.769855 0.00938698C0.834857 0.025172 0.909125 0.050939 0.940039 0.105598C0.974118 0.165853 0.928294 0.24019 0.938405 0.307405C0.945385 0.353808 0.983827 0.391963 0.990109 0.43845C0.99645 0.485376 0.974023 0.531139 0.975024 0.578413C0.976372 0.642059 1.00995 0.70413 0.997058 0.766685C0.982918 0.835287 0.966342 0.922861 0.897739 0.953389C0.825774 0.985413 0.742948 0.907088 0.663414 0.915155C0.591084 0.922492 0.535651 1.01751 0.466363 0.997145C0.392173 0.975339 0.397976 0.866599 0.33914 0.819843C0.291325 0.781845 0.202439 0.802695 0.163852 0.756743C0.125367 0.710913 0.168659 0.638605 0.142702 0.585912C0.111488 0.522548 0.0093475 0.49427 0.000548991 0.425232C-0.00755045 0.36168 0.0762595 0.318433 0.100985 0.258584C0.128414 0.192194 0.0852446 0.0855481 0.154263 0.0531717C0.235575 0.0150286 0.32805 0.117355 0.419007 0.109401C0.480802 0.103997 0.513995 0.0334247 0.573262 0.0165297Z ;
                    M0.504945 0.0798826C0.57125 0.0561591 0.643505 -0.0291317 0.702467 0.0102251C0.769698 0.0551018 0.727095 0.173593 0.759073 0.249511C0.777937 0.294296 0.816483 0.325816 0.849922 0.36029C0.895524 0.407303 0.973401 0.427999 0.993575 0.491272C1.01226 0.549881 0.988074 0.622815 0.948275 0.668763C0.905234 0.718452 0.817377 0.69955 0.772054 0.747013C0.734446 0.786396 0.763216 0.866643 0.723687 0.903953C0.686392 0.939154 0.625385 0.921021 0.57605 0.932012C0.525586 0.943256 0.478017 0.962114 0.426971 0.97006C0.363955 0.979871 0.290214 1.0224 0.23795 0.984648C0.184233 0.945849 0.221886 0.844399 0.180373 0.791946C0.136568 0.736596 0.0181766 0.755904 0.00187867 0.686362C-0.0148224 0.6151 0.0845813 0.568044 0.11206 0.500458C0.131407 0.452872 0.118981 0.396758 0.138872 0.349413C0.159072 0.301333 0.191778 0.260252 0.228256 0.223886C0.265158 0.187098 0.308294 0.158702 0.354063 0.134882C0.402112 0.109875 0.454117 0.0980687 0.504945 0.0798826Z ;
                    M0.573262 0.0165297C0.636415 -0.00147284 0.705922 -0.0061385 0.769855 0.00938698C0.834857 0.025172 0.909125 0.050939 0.940039 0.105598C0.974118 0.165853 0.928294 0.24019 0.938405 0.307405C0.945385 0.353808 0.983827 0.391963 0.990109 0.43845C0.99645 0.485376 0.974023 0.531139 0.975024 0.578413C0.976372 0.642059 1.00995 0.70413 0.997058 0.766685C0.982918 0.835287 0.966342 0.922861 0.897739 0.953389C0.825774 0.985413 0.742948 0.907088 0.663414 0.915155C0.591084 0.922492 0.535651 1.01751 0.466363 0.997145C0.392173 0.975339 0.397976 0.866599 0.33914 0.819843C0.291325 0.781845 0.202439 0.802695 0.163852 0.756743C0.125367 0.710913 0.168659 0.638605 0.142702 0.585912C0.111488 0.522548 0.0093475 0.49427 0.000548991 0.425232C-0.00755045 0.36168 0.0762595 0.318433 0.100985 0.258584C0.128414 0.192194 0.0852446 0.0855481 0.154263 0.0531717C0.235575 0.0150286 0.32805 0.117355 0.419007 0.109401C0.480802 0.103997 0.513995 0.0334247 0.573262 0.0165297Z ;
                    M0.504945 0.0798826C0.57125 0.0561591 0.643505 -0.0291317 0.702467 0.0102251C0.769698 0.0551018 0.727095 0.173593 0.759073 0.249511C0.777937 0.294296 0.816483 0.325816 0.849922 0.36029C0.895524 0.407303 0.973401 0.427999 0.993575 0.491272C1.01226 0.549881 0.988074 0.622815 0.948275 0.668763C0.905234 0.718452 0.817377 0.69955 0.772054 0.747013C0.734446 0.786396 0.763216 0.866643 0.723687 0.903953C0.686392 0.939154 0.625385 0.921021 0.57605 0.932012C0.525586 0.943256 0.478017 0.962114 0.426971 0.97006C0.363955 0.979871 0.290214 1.0224 0.23795 0.984648C0.184233 0.945849 0.221886 0.844399 0.180373 0.791946C0.136568 0.736596 0.0181766 0.755904 0.00187867 0.686362C-0.0148224 0.6151 0.0845813 0.568044 0.11206 0.500458C0.131407 0.452872 0.118981 0.396758 0.138872 0.349413C0.159072 0.301333 0.191778 0.260252 0.228256 0.223886C0.265158 0.187098 0.308294 0.158702 0.354063 0.134882C0.402112 0.109875 0.454117 0.0980687 0.504945 0.0798826Z ;
                "
            /> 
        </path>
    )

    return (
        <>
            <svg fill="none" xmlns="http://www.w3.org/2000/svg"
                style={{...props.style, height: picturePath ? 0 : undefined}} 

                preserveAspectRatio="none"
                viewBox='0 0 1 1'
            >
                {!picturePath ? path : (
                    <defs>
                        <clipPath 
                            id='clipPath'
                            clipPathUnits='objectBoundingBox'
                        >
                            {path}
                        </clipPath>
                    </defs>
                )}
            </svg>

            {!picturePath ? null : (
                <img src={picturePath} className={s.img} style={props.style} />
            )}
        </>
    )
}